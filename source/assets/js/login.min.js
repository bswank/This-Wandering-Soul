/* globals Nanobar, Leafpub */
$(function(){"use strict";var e=new Nanobar,a=$(".login-form").attr("data-redirect");$('[data-toggle="tooltip"]').tooltip({trigger:"hover"}),$(".login-form").on("submit",function(t){var o,i=this;switch(t.preventDefault(),Leafpub.template){case"login.recover":o=Leafpub.url("api/login/recover");break;case"login.reset":o=Leafpub.url("api/login/reset");break;default:o=Leafpub.url("api/login")}e.go(50),Leafpub.highlightErrors(i),$(".form-message").prop("hidden",!0),$.ajax({url:o,type:"POST",data:$(i).serialize()}).done(function(e){if(e.message&&$(".form-message").toggleClass("text-success",e.success).toggleClass("text-warning",!e.success).text(e.message).prop("hidden",!1),e.success){if("login.recover"===Leafpub.template)return void $(i).find(":input").prop("disabled",!0);location.href=a?a:Leafpub.adminUrl()}else Leafpub.highlightErrors(i,e.invalid),$(".login-form").velocity("stop",!0).velocity("callout.shake")}).always(function(){e.go(100)})})});